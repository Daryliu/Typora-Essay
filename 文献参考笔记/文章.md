## 5.6日-5.9日

### 1、基于微服务的金融贷后系统的设计与实现

> etcd：高可用强一致性的服务发现存储仓库

##### 摘要

在gRPC、etcd、Kong网关基础上搭建项目的微服务框架，再对gRPC包进行封装和二次开发，以Sidecar模式加入gRPC gateway和gRPCproxy，使应用服务和辅助服务分离，HTTP请求转为gRPC请求。

**微服务**：微服务架构按业务功能划分，每个服务都具备特定的功能，易于开发以及维护；每个独立的微服务可以由不同的语言基于不同的平台开发，灵活性较好，子服务可独立部署，能够实现可持续集成及交付；单个微服务出现问题不会影响系统其他服务的运行，并且可以实现动态按需实时扩展。

微服务的核心在于基于面向服务的思想，对传统大型应用系统进行功能分解，推动细粒度服务的使用。微服务架构则指根据应用系统的业务需求，通过对预定义的微服务进行重组而形成企业级应用的分布式体系结构。它主要将传统概念上的单体应用在功能、数据等方面进行分解，划分为多个具有明确边界并可被自由重组的小规模子服务。这些子服务间采用轻量级通信方式实现交互、协作，每个服务都有自己的数据库并可在独立进程中被部署、运行等，服务之间保持技术异构性，可由不同的团队选择合适的工具、语言进行开发。 
与单体架构相比，微服务架构的优势有以下几点： 
(1)微服务按业务功能划分，每个服务都具备特定的功能，易于开发、维护等。(2)每个独立的微服务可以由不同的语言基于不同的平台开发，灵活性较好。(3)子服务可独立部署，能够实现可持续集成及交付。(4)容错能力强，单个微服务出现问题并不会影响系统其他服务的运行(5)拓展性好，可按需实时扩展，功能更新迭代快等

<u>**国内**</u>相关文献中对于微服务的研究工作主要集中在将原有的系统微服务化或者利用微服务框架搭建新的系统，专注于功能的实现，解决微服务化过程中遇到的一些问题。

**<u>国外</u>**相关文献中对于微服务技术的研究工作主要分为四个方面，第一方面介绍微服务架构概念，并结合具体工程来说明优势，第二方面开发微服务相关组件或工具，实现微服务架构下的某些关键功能或者组件，第三方面评
估比较不同微服务架构的性能，第四方面讨论企业从单体架构转变为微服务架构的优劣势以及要解决的问题。



> 实现**微服务架构** ：
>
> 需要提供服务注册与发现、服务间通信、服务部署等技术；并添加负载均衡、服务网关和容错机制模块保证服务稳定性和安全性。

##### **服务注册与发现**

单个服务运行在docker中时，是以docker服务实例的方式运行，实例是可以克隆、销毁和重定位的，需要一种动态的服务发现机制可以随时定位服务发现。

**服务注册**，就是将提供某个服务的模块信息(通常是这个服务的ip和端口)注册到1个公共的组件上去（比如: zookeeper\consul）。

![img](https://pic2.zhimg.com/80/v2-e0d57ebf56f9743a03f35e297934d9dd_720w.jpg)

伪代码如下：

```
//给User服务申请1个独有的专属名字
UserNameServer = NameServer->apply('User');

//User服务下的6台docker实例启动后，都去注册自己
UserServer1 = {ip: 192.178.1.1, port: 3445}
UserNameServer->register(UserServer1);

......

UserServer6 = {ip: 192.178.1.6, port: 3445}
UserNameServer->register(UserServer6);

//给Order服务申请1个独有的专属名字
OrderNameServer = NameServer->apply('Order');

//开始注册
OrderServer1 = {ip: 192.178.1.1, port: 3446}
OrderNameServer->register(OrderServer1);
```

**服务发现**，就是新注册的这个服务模块能够及时的被其他调用者发现。不管是服务新增和服务删减都能实现自动发现。

<u>Order服务想要User服务相关的信息，，首先向注册集群中心发送请求获取，然后就能收到User服务相关信息。</u>

![img](https://pic4.zhimg.com/80/v2-7e32eeb70fad22a91e7f8d97088d606b_720w.jpg)

伪代码如下：

```
//服务发现，获取User服务的列表
list = NameServer->getAllServer('User'); 

//list的内容
[
    {
        "ip": "192.178.1.1",
        "port": 3445
    },
    {
        "ip": "192.178.1.2",
        "port": 3445
    },
    ......
    {
        "ip": "192.178.1.6",
        "port": 3445
    }
]
```

##### **服务网关** 

##### **负载均衡**

##### **服务容错**

##### **服务部署与通信**

#### gRPC框架

gRPC 也是基于以下理念：定义一个服务，指定其能够被远程调用的方法（包含参数和返回类型）。在服务端实现这个接口，并运行一个 gRPC 服务器来处理客户端调用。在客户端拥有一个存根能够像服务端一样的方法。 

1. 基于 HTTP 2.0 
2. 使用 ProtoBuf  
3. 多语言支持

**gRPC负载均衡**

（1）服务启动后 gRPC 客户端向命名服务器发出名称解析请求，名称将
解析为一个或多个 IP 地址，每个 IP 地址标示它是服务器地址还是负载均衡
器地址，以及标示要使用那个客户端负载均衡策略或服务配置。 

（2）客户端实例化负载均衡策略，如果解析返回的地址是负载均衡器地
址，则客户端将使用 gRPClb 策略，否则客户端使用服务配置请求的负载均
衡策略。 

（3）负载均衡策略为每个服务器地址创建一个子通道。 

（4）当有 RPC 请求时，负载均衡策略决定那个子通道即 gRPC 服务器
将接收请求，当可用服务器为空时客户端的请求将被阻塞。



#### 技术架构 

##### 服务接入层

###### 接入Kong网关

项目在服务接入层对请求实行统一接入和管理，使用 Kong 网关作为客户端和消费端接入微服务的唯一入口，在网关可以进行统一的服务接入，流量控制，安全防护，限流熔断以及性能监控，使服务本身可以更专注于自己的逻辑实现。同时，只需简单的配置即可将开发的服务发布出去。因此服务的开发者便捷地对外提供服务。 

Kong 是一个基于 Nginx/OpenResty 的开源 API 网关，使用 lua 进行插件开发，其主要特点有,基于 Nginx，稳定性高,节点水平扩展，基于 REST API，通过 REST API 配置服务，路由及插件，可以从繁琐的配置文件中解放出来，支持熔断，限流，健康检查以及提供了实时监控功能。 

项目在请求经过 Kong 网关时，统一进行请求参数签名、Prometheus 监控（针对请求速率，请求时延，签名校验失败次数等进行统计）以及统一的token 检验和验签。

###### 部署gRPC proxy以及gRPC-gateway

使用开源中间件 gRPC gateway+gRPC proxy，通过 Sidecar 方式部署 gRPC proxy 与 gRPC gateway，能够实现服务自动发现。







### 2、微服务体系结构实现框架综述

##### 摘要

论述面向服务体系结构SOA、 Web服务及微服务相关概念并作比较； 给出微服务体系结构实践中的关键技术以及核心功能模块； 分析对比主流微服务体系结构实施框架及其核心部件的特征和差异； 探讨微服务组合面临的挑战及微服务框架中的服务组合方案。

##### 引言

 **单体架构**存在较多不足。首先，单体应用的代码庞大，代码耦合度高，系统灵活性较差；其次，单体架构受技术限制，所有模块都采用相同技术，难以实现技术协同；第三，单体应用的创建或部署时间较长、成本较高，难以实现持续发布及部署。更为重要的是，单体应用难以被扩展，可伸缩性较差。

 **与Web服务相比**， 微服务更具优势， 例如采用去中心化管理及轻量级容器部署， 提供监控预警及多种高可用容错策略， 服务数据独立且开发自由。

##### Web服务与微服务

**微服务**其核心要义在于基于面向服务的思想， 对传统大型应用系统进行功能分解， 推动细粒度服务的使用。微服务架构（MicroServices Architecture， MSA） 则指根据应用系统的业务需求， 通过对预定义的微服务进行重组而形成企业级应用的分布式体系结构。它主要将传统概念上的单体应用在功能、 数据等方面进行分解， 划分为多个具有明确边界并可被自由重组的小规模子服务。这些子服务间采用轻量级通信方式实现交互、 协作， 每个服务都有自己的数据库并可在独立进程中被部署、 运行等，服务之间保持技术异构性， 可由不同的团队选择合适的工具、 语言进行开发。

 微服务架构的优势在于：（1） 微服务按业务功能划分， 每个服务都具备特定的功能， 易于开发、 维护等；（2） 每个独立的微服务可以由不同的语言基于不同的平台开发， 灵活性较好；（3） 子服务可独立部署， 能够实现可持续集成及交付；（4）容错能力强大，单个微服务出现问题不会影响系统其他服务的运行；（5）可实现动态按需实时扩展等。

**Web服务**重在解决异构资源的整合，通过企业服务总线ESB将不同服务集成到企业应用中；其重量级特性使灵活度降低，不能很好的支持大型企业级应用的持续变更、发布和部署

微服务采用轻量级协议，也没有重量级ESB，去中心化，独立业务功能和独立数据库，单独部署运行在轻量级Docker容器中实现敏捷开发

|          Web服务体系           |           微服务架构            |
| :----------------------------: | :-----------------------------: |
|   企业级， 自顶向下展开实施    |    团队级， 自底向上展开实施    |
| 服务由多个子系统组成， 粒度大  |  系统被拆分为多个服务， 粒度细  |
|   企业服务总线， 集中式开发    |  去中心化管理， 松散的服务架构  |
| 集成方式复杂 （ESB/WSDL/SOAP） | 集成方式简单 （HTTP/REST/JSON） |
|    服务依赖性强， 部署复杂     |    服务彼此独立， 能单独部署    |





### 3、基于RPC的高并发网络通信中负载均衡的研究

高并发指多个用户同时发送请求，此情况下服务器资源利用率相应上升，到达阈值后服务器性能会缓慢下降甚至骤然降低。<u>面对如此海量的并发请求时，后台服务要保持原有即时、流畅、稳定的用户体验</u>，就需要有良好的网络通信架构的支撑，本文选择对 RPC 进行深入研究。

对于大型的网络应用提供商，它所有的网络服务不会部署在同一台服务器中，而是分别部署在不同地域、性能的服务器集群中。服务消费方想要调用另一个服务提供方的服务，开发人员就需要写大量和网络通信相关但与业务无关的多余代码，此方法不但增加了程序的复杂度，同时还容易产生错误。**远程过程调用**（Remote Procedure Call，RPC）的概念就是能让程序开发人员类似于调用本机自身服务一样的方式和效率来调用其它远程服务器中的服务，同时开发人员也不需要在代码中实现具体的网络通信，它能够在一定程度上提升后台间服务互相调用的效率。

**规范的 RPC 请求**一般为服务消费方发起 RPC 请求，服务消费方绑定参数打包发送给服务注册中心，注册中心搜索此服务的相关服务提供方，选择适合的服务提供方，提供方解绑参数再处理请求再绑定参数并打包，最终通过注册中心解绑参数返回给服务消费方；			自从引入了 RPC 技术，其开发的网站架构就具有了可以轻松地平行向外拓展等优点

研究RPC负载均衡中<u>“最快相应算法”、“动态硬件监控”、“加权轮询算法”</u>（加权轮询算法：把来自用户的请求轮流分配给内部的服务器：从服务器1开始，直到服务器N，然后重新开始循环。也可以给每个服务器设定一个固定的权重值，按照权重值来实现轮询）

##### RPC 有以下几个特性

一、普遍性，能支持较为高级的数据结构；二、高性能，减小了时间复杂度，同时也降低了空间复杂度；三、可扩展性，可以轻松地横向拓展，大大提升了系统的健壮性[3, 26, 27]。因此，RPC 框架就是可以让程序开发人员来调用远程进程中代码的一套工具，实现了不使用多线程、Socket 等来开发高性能系统。常用 RPC 框架有谷歌 gRPC、Apache Thrift、阿里巴巴 Dubbo、Redhat Wildfly 等。 

##### gRPC框架

自动对结构化数据进行序列化、反序列化的机制，即 Protobuf (Protocol Buffers)；**通过序列化速度和内存占用等对比，它经常会被用于数据缓存、数据交互、通信方式优化等多方面**

gRPC 是谷歌公司最近公布的开源软件，它基于最新的 HTTP2.0 协议，并支持常见的多种编程语言。HTTP2.0 是基于二进制的 HTTP 协议升级版本，目前各大浏览器都在加快支持的进度。若未来浏览器支持 HTTP2.0，并通过现有开源序列化库比如 Protobuf 等，可以直接和其它语言的服务进行高效交互，这将是 gRPC 最好的使用场景。它的底层网络库基于 Netty，并使用最新的 Netty 5.0.0.Alpha3 的开发版本，所以最新版本针对 HTTP2.0做了很多改进；为了跨语言，g PRC 也和其他常用框架一样，采用了类似原生 IDL（Interface Definition Language）的接口描述语言，利用 Protobuf 项目自带的 protoc 编译器来生成框架代码。

![img](https://upload-images.jianshu.io/upload_images/5522013-a5a60ac7db59909f.png?imageMogr2/auto-orient/strip|imageView2/2/w/763/format/webp)

![img](https://upload-images.jianshu.io/upload_images/5522013-50c9764316493d22.png?imageMogr2/auto-orient/strip|imageView2/2/w/912/format/webp)

##### Thrift框架

##### Dubbo框架

##### 数据缓存模块

因为高并发请求时，短时大量的请求对于负载均衡的实时性要求较高，单纯的关系型数据库服务由于需要连接数据库、读写数据等数据库操作，每次存取都对数据库进行操作 的话开销会很大，并且一个数据库池的连接数到达上限之后，数据库效率还会大大下降。高并发请求时需要高频率地对动态权重值进行更新操作，且中间变化的权重值实际上不需要全部记录只需要控制台留下记录即可，因此，纯数据库模式不适用于本研究，需要使用<u>缓存技术在负载均衡器和数据库之间增加缓存层用来进行数据动态缓存</u>，一段固定时间后更新数据库数据防止断电等意外中断造成的数据丢失。

 

## 5.10-5.15

### 4、有关远程过程调用的几个重要问题的讨论

RPC中的问题：1、网络传输协议2、类型一致性3、错误处理4、故而问题5、效率问题6、性能问题7、互操作性

##### rest及restful

> 介绍REST

rest（Resource Representational State表现层状态转移），是一种**<u>架构风格</u>**；各种类型的Client层出不穷，**RESTful可以提供一套统一的接口**为 Web，iOS和Android提供服务；

REST就是选择通过使用http协议和uri,利用client/servermodel对资源进行CRUD(Create/Read/Update/Delete)增删改查操作。

Transfer：通俗来讲就是：资源在网络中以某种表现形式进行状态转移。分解开来：
		  Resource：资源，即数据（前面说过网络的核心）。比如 newsfeed，friends等；
		  Representational：某种表现形式，比如用JSON，XML，JPEG等；
		  State Transfer：状态变化。通过HTTP动词实现。

![img](https://pic4.zhimg.com/80/06ee404783540f0af299042057738a99_720w.jpg?source=1940ef5c)



描述的是在网络中client和server的一种交互形式；REST本身不实用，实用的是如何设计 RESTful API（REST风格的网络接口）；

![img](https://pic1.zhimg.com/80/7405939b62a73f28846533de08db3a80_720w.jpg?source=1940ef5c)

<u>Server和Client之间传递某资源的一个表现形式</u>，比如用JSON，XML传输文本，或者用JPG，WebP传输图片等。当然还可以压缩HTTP传输时的数据（on-wire data compression）

<u>用 HTTP Status Code传递Server的状态信息</u>。比如最常用的 200 表示成功，500 表示Server内部错误等；

前段渲染和附带处理简单的商务逻辑（比如AngularJS或者BackBone的一些样例）。Web端和Server只使用上述定义的API来传递数据和改变数据状态。格式一般是JSON。

> 简单介绍REST的优点

1、客户-服务器(Client-Server) 客户端服务器分离

优点：提高用户界面的便携性(操作简单)

通过简化服务器提高可伸缩性(高性能，低成本)

允许组件分别优化(可以让服务端和喀户端分别进行改进和优化)

2、无状态(Stateless)

从客户端的每个请求要包含服务器所需要的所有信息

优点:

提高可见性(可以单独考虑每个请求)

提高了可靠性(更容易从局部故障中修复)

提高可扩展性(降低了服务器资源使用)

3、缓存(Cachable)

服务器返回信息必须被标记是否可以缓存,如果缓存，客户端可能会重用之前的信息发送请求。

优点:

减少交互次数

减少交互的平均延迟

4、分层系统(Layered System)

系统组件不需要知道与他交流组件之外的事情。封装服务,引入中间层。

优点:

限制了系统的复杂性

提高可扩展性

5、统-接口(Uniform Interface)

优点:

提高交互的可见性

鼓励单独改善组件

6、支持按需代码(Code-On-Demand 可选)

优点:

提高可扩展性

### 5、基于微服务的极地科考信息资源集成管理研究

> 通过微服务的方式构建两级可靠信息资源管理平台，实现稳定性和可靠性

使用Nacos进行服务注册和服务发现 

对比了单体架构\SOA架构\微服务架构

集群部署

### 6、gRPC：分布式系统中的通信协作机制

> 主要讲解了组远程过程调用来解决RPC中的缺陷

`gRPC具有以下优点：高性能重量轻支持双向流传输支持使用协议缓冲区的二进制序列化*支持与语言无关的实现gRPC通信模式gRPC支持以下通信模式`。

RPC .~系统在并行性、可靠性和透明性方面存在一定的缺陷，只能支持点对点和(或)广播通信，不支持一对多的通信。现在**gRPC添加了关于流式通信的机制**

文章中提出的**“组远程过程调用”**来解决原有rpc中并行、可靠和透明性的问题；实现支持分布式系统中实体间协作的新型通信协作机制，包含GRPC查找、GRPC函数收敛和GRPC更新。

1. 复杂程序调用：提高系统的容错能力
2. 容错RPC机制
3. 真实组通信机制：保证数据传递的原子性和事件传递的顺序，简化了分布式应用得设计
4. 广播通信原语：

- lookup GRPC 机制：提高系统得响应时间，当一个客户端发起GRPC调用时，同时调用被调用服务组下的所有成员；当所有成员都失败时才会返回失败
- function-convergence GRPC 机制：可以同时调用多个服务器处理数据，提高并行执行，提高透明度
- update  GRPC机制：只有当客户端从被调用的RSG的每个成员处获得成功的回复时，GRPC调用才会成功地返回。或者，如果被调用的RSG中的任何一个成员宣布失败，GRPC调用将立即返回失败



### 7、REST、SOAP、Socket和gRPC在移动应用程序计算卸载中的比较:能源成本分析

> 内容：评估不同通信协议和架构风格，即REST、SOAP、Socket和gRPC，在执行不同复杂度、不同输入大小和类型的算法时的能耗。

物联网的日益普及使移动环境成为许多进步的目标，导致硬件和软件更加复杂。自然，这种进步是有代价的:能源消耗的持续增长。不幸的是，电池技术的发展历史上非常缓慢。锂电池的密度每年提高10%左右，但其能量容量取决于其大小。因此，只有更大的设备才能从电池的自主性中获益。然而，增加设备的尺寸却违背了消费者的偏好:约98%的移动设备用户更喜欢5英寸左右的屏幕，但预计每一代设备都将呈现更多的传感器和新的外围设备，这将需要更多的能量【`可用于写在gRPC http2.0有效减少电池消耗和流量消耗上`】

计算卸载用于减少能耗，即将特定的计算任务转移到外部平台，如集群或云；



### 8、多对多异步Web Services实现分布式GIS的研究  

> 以 agent group作为前端的多对多远程调用综合服务系统的框架 
>
> 考虑到在一次调用中客户提出多个服务请求的情况 ，提出了多对多异步模型 ，讨论了该模型的各个组成部分的功能及调用关系 ，并进一步阐述了运用线程池和异步技术实现模型的方法   

`Web Services`依靠Internet标准使每个Web服务都被定义了唯一的接口，任何客户端访问的方式都是一样的，即再Http上使用SOAP。

##### 多对多的异步RPC模型

异步RPC不阻塞调用者，并在Client需要时能够得到调用结果，这样Client可以和Server并行的执行【<u>但是没有解决“在一次调用中能否提出多个服务请求的问题和对多个提出服务请求的问题</u>】

`使用Agent-Group来解决上述多对多调用的问题`。

### 9、海洋地质大数据信息服务体系建设

> 利用互联网Web平台及Web开发技术，构建基于REST风格 API的轻量级Web服务

基于API的轻量级Web应用通过平台独立、低耦合、自包含的应用程序组件实现，与客户端之间采用开放协议通信，客户端只要使用浏览器即可与服务器端交互，消费服务器端提供的 Web服务；

##### 构建REST风格的API

REST风格 Web服务使用 HTTP（S）作为底层协议，以HTTP方法（POST\GET\PUT/PATCH、DELETE）作 为 统 一 接 口 实 现 对 资 源 的 CRUD（创建、读取、更新、删除）基本操作

HTTP协议的无状态性以及资源的 URL可寻址性有利于服务的云平台部署；其次，资 源URL寻址使得服务与数据的物理存址无关，避免数据物理集聚可能 带来的机构协调与工作负荷问题，有助于数据共享和互操作；

客户端请求之后，服务端返回的不是资源本身，而是资源表述（其是资源对象按照一定格式JSON\XML序列化形成的文件，便于网络传输）

##### 交互数据可视化

数据可视化是将JSON、XML等格式的资源表述内容映射导Web页面的过程；

### 10、镜像构建系统的设计与实现

通过Go语言，各个模块独立运行于各自的Docker容器中，相互之间通过gRPC通信协作；对外使用了RESTful API接口，用来统一管理各应用的镜像构建与管理

> Docker的含义及作用

Docker是一个开发，部署，运行应用的开放式平台，提供了软件领域的一种标准化，将应用以及运行环境按照某种标准规格打包起来，也就是镜像，极大程度的减轻了应用安装配置等部署工作。与虚拟机不同，容器内的应用没有自己的内核，而是直接运行在宿主机的内核之上，从而比虚拟机更轻便，可以做到秒级甚至毫秒级的启动，同时在资源利用上对比虚拟机，利用率也更高。Docker容器可Ｗ很容易的在不同的平台间移植，Docker提供的标准化，可以保持跨环境的一致性。同时，Docker提供容器级别的隔离，两个容器内所运行的应用以及所使用的依赖与资源是相互隔离的；

> 使用Docker的不足

在需要下载一些大型资源或者被墙资源时，耗时较长，乃至经常失败。同时，对于Docker private Registry的管理也常常因为一些开发者的不规范使用陷入一些复杂的情况。因此，希望能统一实现Docker image的构建与管理。

> 文章中对gRPC的介绍

gRPC是一个高性能的，开源的，通用的RPC框架。在gRPC里client端可以方便的调用服务器端的方法与之交互，就像调用本地对象一般，从而使开发者可Ｗ更加简单的构建分布式应用和服务。类似许多RPC系统，gRPC也是基于下理念：定义一个服务，指定其可以被远程调用的方法。然后再服务器端实现这个方法，在客户端有一个stub可以用来调用服务端的方法。

gRPC允许４种类型的rpc方法，简单rpc，客户端流式rpc，服务器端流式rpc，还有双向流式rpc方法。简单rpc方法就像平常的调用一样发送请求并等待响应。而客户端流式rpc方法允许用户将请求写入消息序列并等待服务器读取完成返回响应。服务器端流式rpc方法则是客户端发送请求后，会拿到一个流，从中读取返回的消息。最后，双向流式rpc方法，客户端服务端双方都通过读写流去发送消息序列，相互间独立，双发可任意喜欢的顺序读写。

gRPC基于HTTP2.0标准设计，IDL采用protocol buffers，简单易用，并且拥有双向流，多路复用，头压缩等特性。它的优势在于Protocol Buffer是一种很高效的序列化技术，性能很不错，同时，采用HTTP2.0协议，添加了头信息，可以方便的对调用进行控制，比如安全认证，限流等。但同时，<u>也因为添加了头信息，从而比较耗资源，性能方面不如Thrift。</u>

### 11、基于Docker和K8s的深度学习容器云平台的设计与实现

> 介绍了关于Docker和K8s技术中有关深度学习的部分内容，并在存储方式上使用“对象存储”（对象存储是一种高性能、高可靠性、跨平台、安全的分布式存储结构，特点是数据存储持久、数据高可用、存储空间可扩展、高效容灾等）；文中使gRPC和RESTful API来对外传输信息

##### 设计原则

1. 高内聚低耦合

   意在把模块间的耦合降到最低，而努力让一个模块做到精益求精。内聚指一个模块内各个功能点彼此结合的紧密程度，耦合指一个软件结构内不同模块之间的相互联结紧密度。内聚意味着重用和独立，耦合意味着多米诺效应，容易牵一发而动全身。所以在设计之初就应当对模块进行详细划分，各司其职，而不是乱作一团

1. 兼容性准则

   虑到供给其他系统调用接口，以及平台后续的迭代升级，设计上要对接口保持＿定的兼容性。服务端采用Java语言，具有很好的跨平台兼容性；数据通信采用Protobuf定义消息格式，特点是解析快，体积小；接口整体风格采用RESTful 风格，特点是跨平台，易接入；前端设计采用Node JS进行开发，特点是跨平台，性能好。

2. 高性能准则

   底层资源隔离、分配采取了轻量级的容器技术如Docker和K8s，相对于传统的KVM尽可能缩短了创建隔离环境的时间消耗；平台使用了Protobuf定义了协议，通过Protobuf序列化的数据，体积相比JSON和XML小很多，且解析速度也很优秀。

### 12、基于WebGIS的GIS网络虚拟实验室建设

> 核心思想是想要利用REST服务和Ajax构建一个虚拟实验室（类似中国大学MOOC）

GIS网络虚拟实验室REST服务层：该层提供操作底层各种数据库的REST 服务接口，针对每个数据库，提供数据的添加、查询、更新和删除接口；

实现：

服务端以REST 服务形式提供虚拟实验室各种数据库的操作接口，虚 拟 实 验 室 客户端使用 Ajax 请 求 方 式 与REST 服务进行通信，由于采用了无状态的通信机制，在大量学生用户并发访问虚拟实验室场景中，可以在云环境中部署多个 REST 服务结点，然后采用笔者提出的 Client主动式负载均衡方法，在虚拟实验室客户端实现多个REST 服务结点的均衡调度，满足大用户量的并发访问性能需求  

### 13、远程过程调用技术在分布式软件系统中的应用  

> 基于开源的Thrift 框架，搭建了一套面向服务化的 RPC 通信中间件 ，通信中间件重新封装 RPC 核心框架并提出一种精简的分布式服务发现功能 ；

文章提出通过应用远程过程调用技术 ，可快速标准化组件间交互接口并提升开发集成效率  ；通过屏蔽网络和设备差异，便捷的调用网络中另一应用所提供的对外接口；

RPC 本质上是一种高度封装的网络层之上的应用协议栈，结合标准化 IDL 接口，约束通信双方的请求和响应行为，提供网络透明化的<u>虚拟本地</u>调用方式  

##### RPC关键技术

1. 序列化

    用于对请求和响应的数据信息执行对称编码和解码；关键评价维度：跨语言、兼容性、编码后长度紧缩能力；

2. 传输协议
   基于网络层协议栈，实现传输层封装，提供多种传输协议解决方案；
   关键评价维度：链接管理（心跳、重连）、报文交互设计、可靠分包能力、
   传输延迟时间；

3. I/O 处理机制 

   提供服务端运行框架和事件驱动异步收发机制；关键评价维度：并发请求处理个数 / 秒、并发请求响应延时；

4. 服务治理 

   提供服务发现、注册、监控等公共业务，确保系统或调用便捷可靠；  

##### Thrift

优势：

1. 低延迟、高扩展，同类开源框架中被验证性能最优；
2. 丰富的序列化方法、传输协议、服务端类型可选组合项；
3.  IDL 设计支撑了较好的接口变更兼容性、可读性；
4. 应用时间最久， C++ 语言支持最完整。 

由于 Thrift 采用 TCP 长连接、支持线程池、实现异步 I/O 技术、紧缩的序列化编码，其<u>传输性能大幅优于其它同类框架</u>  

---

## 5.12

##### http协议无状态

1. 协议对于事务处理没有记忆能力（事务处理、记忆能力）
2. 对同一个url没有上下文关系（上下文能力）
3. `每次请求都是独立的`，它的执行情况的结果与前面、后面的请求是无直接关系的
4. 服务器中没有保存客户端中的状态，客户端每次必须带上自己的状态去请求服务器的状态



### 14、基于微服务架构的金融成本决策系统设计与实现（开题可参考）

##### 国内外现状

国外相关研宄文献中关于微服务技术的研究工作可以分为三个方面：`介绍微服务体系结构，并结合具体项目来说明其效果`；开发与微服务有关的组件或工具，以实现微服务架构下的一些特殊功能；讨论公司从单一架构更改为微服务架构时可能遇到的原因和问题

##### 服务网格

服务网格是一种控制应用程序不同部分如何彼此共享数据的方式，与用于管理此通信的其他系统不同，服务网格是内置在应用程序中的专用基础结构层，可以轻松地优化通信；

##### 文章内研究内容

1. 首先针对微服务框架，微服务网关，消息队列等核心技术进行分析，并针对gRPC进行封装二次开发，完成系统的搭建与实现。对系统进行详细设计与实现，开发实现核心接口
2. 设计前置规则集过滤
3. 通过研究分析公司现有贷款成交数据和资金方银行审核通过数据探究其中影响资金方银行放款的因素，总结规则模型算法，实现成本排序算法，实现三级快照归档存储。试算金融产品包且路由选择金融产品，采用异步调度的方式实现异步审核任务池。实现规则的变量管理，采用分布式发布者订阅者模型实现配置实时加载更新内存数据，并且降低处理时延。

[https://zhuanlan.zhihu.com/p/367225970]: 

##### 微服务要解决的问题

1. 服务划分
2. 服务注册与调用
3. 延迟队列
4. 服务熔断处理
5. 缓存设计
6. 分布式事务实现

###### 展望 1：

服务网格将请求从一项服务路由到下一项服务，从而优化所有活动部件如何协同工作，是微服务将来的发展趋势，也是具有极大的探索价值

###### 展望 2：

云平台



### 15、基于REST_Web_Service的自发地理信息应用研究

> 基于REST Web Service平台，利用 Openlayers、GeoServer、ArcGIS  Server 等开源和专业软件，完成地图加载、地图发布和后台数据处理工作。 

##### 研究成果

REST  Web  Service 可降低开发的复杂性，同时提高系统的可伸缩性。采用开源的将移动开发框架，利用 OpenLayers 完成服务的加载，可实现应用程序的跨平台调用，同时降低自发地理信息的专业性。利用 GeoProcessing  Service 进行数据处理，可实现轻量级的高复杂度的数据分析功能，满足 GIS 应用中的多样化的处理需求。 

#### 可以借鉴并写在文中的内容

本文就三维网格压缩算法自研究以来的数个经典算法做了简要分析介绍,并提出了一种新的单分辨率三角形网格拓扑编码算法,主要思路包括同心环面片的分割,网格生成树的构造,由内而外的层次遍历方式,创新性地解决了生成树编码过程中遇到的顶点分裂与边分裂的问题。同时提出了一种基于局部柱坐标系变换的几何数据预测编码算法。在本文中我们详细介绍了该算法的具体思路与算法细节,并就多个三维网格模型做了大量实验,我们认为这个压缩方法能够在保证网格失真情况在可以接受的范围内的同时得到较好的压缩效率。同时,对于后一个问题,即如何应对不可靠网络的情况的问题,由于我们的方法将网格模型保存在结构化的树形结构中,我们认为这种编码方法能够方便地处理客户端丢包后快速重新向服务器端请求并恢复网格的问题。在本文中我们对三种不同的网格传输策略做了实验对比,就实验结果做了初步的分析与研究。

### 16、电磁频谱监测系统中间件设计实现方法

##### RPC和gRPC

RPC遵从server/client模型，实际使用时，客户端调用服务端提供的接口就如同本地调用，且不需要开发网络通信和协议层的功能，只需关心业务相关的服务；

gRPC  框架是一个由谷歌开发的语言中立、平台中立、开源的 RPC  框架，它面向  HTTP/2  设计、使用  protobuf  作为数据序列化协议，并且具有解析速度快，序列化数据体积小，可扩展性高，使用简单等特性，相比其他RPC框架而言，发展空间更大。

##### 定义gRPC服务

首先，按照要求生成gRPC服务接口。gRPC通过 Protobuf（Google  protocol  buffers）定义服务以及生成客户端与服务端的接口执行代码。Protobuf  是谷歌提出的一种数据序列化协议，它的语言无关、平台无关、可扩展的特性，使得它十分适合用于gRPC框架实现数据传输。它最大的特点是能够根据用户自定义的远程调用服务文件（.proto文件）转换成目标语言的头文件与接口实现文件，从而用户可以方便地调用服务接口函数，实现客户端请求的服务功能。定义gRPC服务需要两步：

1)  编写proto文件

proto文件相当于待传输的消息模板，它定义了需要传输的数据本身，主要包括服务端与客户端的接口和消息。·接口：是客户端与服务端远程过程调用的函数接口，该接口定义可表达四种类型RPC方法（例如：简单RPC、流式RPC）。接口定义需遵循规定的格式，即由service  关键字引导具体的服务接口名称，大括号内包含具体的RPC方法（服务接口函数）列表；

2)  编译proto文件

##### 结论

基于gRPC框架设计实现中间件，是将复杂的系统模块功能或业务拆分为多个服务功能，且每部分可独立并行开发、测试以及环境部署，实现了功能高内聚、接口低耦合；同时gRPC框架完成了网络数据传输与序列化，能够有效提升网络传输效率。

## 5.13

### 17、面向微服务架构的负载均衡算法综述

##### 待解决问题

在微服务架构中如何保持各服务器的负载相对均衡是亟待解决的问题，现在解决问题的办法是通过负载均
衡算法来平衡微服务架构中各服务器的负载，保持系统的高可用性。

##### 研究内容

介绍了微服务框架及其相关框架，详细介绍了Spring Cloud框架的工作原理，然后分析了加权最小连接数算法、加权轮询算法等负载均衡算法。

##### 负载均衡算法

###### 动态负载均衡

动态负载均衡算法根据当前的服务器状态分配任务，如最小连接数算法、加权最小连接数算法等；

优点：动态负载均衡算法可根据服务器的实时负载状况，自动将请求分配给合适的服务器，从而提高系统的整体性能，因此动态负载均衡算法在实际系统开发中得到了广泛应用；

###### 静态负载均衡

静态负载均衡算法按照固定比例分配任务，如轮询算法、加权轮询算法等。

优点：静态负载均衡算法的优点是简单，缺点是没有考虑到服务器的性能和当前负载状态，在算法执行一段时间后会破坏服务器之间的负载均衡状态；

##### 微服务架构

Motan、Dubbo 属于服务治理型框架，更侧重于服务治理，主要提供全面的服务治理功能。与 Dubbo 框架相比，Motan 框架去除了Dubbo 框架部分不常用的功能，虽然Motan 框架功能减少了,但Motan框架变得比较简单、易用；

##### 静态负载均衡算法

（1）轮询算法

轮询算法是将请求轮流分配给服务器。假设有n台服务器Sk(k=1,2,...,n),Si表示上一次选择的服务器，i 的初始值为 n - 1。当 j 满足式 j = (i + 1)%n 时，将最新的连接请求发送给服务器Sj。轮询算法假设所有服务器的软硬件配置都相同，即处理请求的效率相同，不考虑每台服务器目前的使用情况，即当前已连接数量和网络带宽等因素。当每次请求服务的间隔时间浮动较多时，轮询算法将会导致每台服务器的负载不是很均衡。所以这种负载均衡算法只适用于各服务器的 CPU、内存、软件等配置都相同的情况。

（2）加权轮询算法

加权轮询算法是根据每台服务器处理请求的能力不同，给每个服务器分配不同的权值，使请求被分配到合适的服务器。假设有 n 台服务器 Sk(k=1,2,...,n),Hk为服务器 Sk的权值,Hmax为所有服务器权值的最大值，G为所有服务器权值的最大公约数。当接收到一个请求时，由服务器Si来处理,并且服务器Si在接收请求时的权值为 Wi。Wi 的初始值为 Hmax,并且满足Wi = Wi - G,如果Wi的值为0时，则将其重置为Hmax。Wi的值从Hmax到0的过程，成为一个轮回，Wi的值的变化序 列 是 一 个 等 差 数 列 : Hmax,Hmax - G,Hmax - 2G,Hmax -3G,...,0。加权轮询算法的结果是根据服务器的配置得到一个服务器序列，对于Wi的每个值，加权轮询算法将遍历所有服务器，将权值大于 Wi 的服务器放到序列中，然后 Wi 变成下一个值，再遍历所有服务器，直到 Wi 的值为 0。在 Wi 变化的过程中，不论 Wi 为何值，权值为 Hmax 的服务器每一次遍历中都会被选中，因此权值为 Hmax 的服务器在算法结果的服务器序列中会出现Hmax/G次，并且当Wi的值为Hwi时，权重为Hwi的服务器在Wi后面的遍历过程中，每一次都会被选中，并且会在结果序列中出现Hwi/G次，所以每个服务器在算法结果的服务器序列中出现的次数与其权值成正相关性。

### 18、基于 RPC 的高并发网络通信中负载均衡的研究

##### 研究内容

RPC 负载均衡中的三个关键部分——最快响应法算法、动态硬件监控以及加权轮询算法

###### 加群轮询算法

RPC 的加权轮询算法是基于分布式的服务器负载均衡策略，注册中心收到服务消费方的 RPC 请求，通过设置好的权重值循环读取空闲的服务器，将请求打包发送至相应的服务提供方，服务提供方解包，对数据进行后台处理后再打包，注册中心解压服务提供方的包，返回结果给服务提供方。当大量的并发请求发生时，固定的权重值会增加权重值较高服务器的压力，并降低其响应速度，因此需要对权重值进行动态调整，来保证性能更好的服务器能够提供更稳定的服务；

##### 创新点

对 RPC 请求的响应时间以及服务器集群的动态硬件资源监控进行了研究和分析，提出了一种<u>**基于 RPC 实时反馈的动态加权轮询负载均衡策略**</u>

##### RPC发展现状

1982 年，Nelson 在博士论文中首次提出 RPC 的概念，即一种进程间的同步通信理论[2]。规范的 RPC 请求一般为服务消费方发起 RPC 请求，服务消费方绑定参数打包发送给服务注册中心，注册中心搜索此服务的相关服务提供方，选择适合的服务提供方，提供方解绑参数再处理请求再绑定参数并打包，最终通过注册中心解绑参数返回给服务消费方。RPC 的理论策略和一般的过程或进程间调用类似，但是 RPC 需要被调用的服务实际部署和运行的服务器和客户端服务器并不在同一网络位置，这就是它们的主要区别。RPC 是为了实现网络应用程序间互相调用而设计的，它可以使调用者无需了解底层网络细节就可以开发 C/S（客户端/服务器）系统。

架构的发展一般经过了 B/S（浏览器/服务器）架构，前端和后端分离的独立系统架构等过程，自从引入了 `RPC 技术，其开发的网站架构就具有了可以轻松地平行向外拓展等优点`；为了应对大量的并发请求，引入 RPC 技术进行后台通信，可以大大减少后台服务通信的开发成本和调用时间

##### 国外发展现状

2007 年，Facebook 公司为了解决网站中的数据传输以及通信问题，开发了一套 RPC框架 Thrift，并在之后授权 Apache 将其开源。它同时也解决了跨平台的问题，即不同开发语言环境可以正常互相访问[6]。随后，Google 也发布了一种自动对结构化数据进行序列化、反序列化的机制，即 Protobuf (Protocol Buffers)。通过序列化速度和内存占用等对比，它经常会被用于数据缓存、数据交互、通信方式优化等多方面；

## 开题思路

1. 基于gRPC微服务架构的城市地质信息平台关键技术研究【论文名称】
2. 软件体系结构【研究方向】
3. 研究点
   1. gRPC划分策略（粒度划分、部署策略）
   2. 服务接口定义方法
   3. 消息传输、响应机制（包含前后台间通信、后台间通信、服务代理）
   4. 负载均衡算法应用
4. 应用点
   1. 数据管理
   2. 制图方面
      1. 剖面图
      2. 地质图
      3. 分区图
      4. 等值线图
      5. ...
   3. 建模方面
      1. 钻孔建模
      2. 结构建模
      3. 桩基建模
      4. ...