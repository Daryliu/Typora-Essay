# `GRPC`:分布式系统中的一种通信合作机制---组远程过程调用

###### 1、原始`RPC`系统存在问题:

并行性、可靠性和透明性方面存在缺陷,只能支持点对点和广播通信，不支持一对多通信。

**点对点**方式在实现不同处理如加减乘除等时只能顺序调用，延长等待时间。

调用者出现问题后，被调用者一直在`running`，成为孤立进程。独力失效的方案会影响其可靠性和透明度。

###### 2、作者提出的解决方案：

将过程组引入`RPC`系统，提出支持分布式系统中分布式实体间写作的新型通信协作机制。

###### 3、`RPC`机制

`rpc`的**调用者和被调用者**位于不同计算机上的**不同进程**。**调用参数和返回结果**通过底层网络例以**消息**的方式**传递**。

###### 4、组机制的分布式程序

组团队中**只要有一个成员存活，就可以持续执行**。只有当所有被调用的`RSG`成员都声明了失败时，`GRPC`调用才会返回失败。

分布式组机制会将不同处理分散到不同的自治处理器中。

###### 5、lookup GRPC机制

文章中讲述的`lookup GRPC`机制：

1. 当结果处理程序得到被调用的所有成员都失败时，客户端存根会将失败的grpc调用符号返回给客户端；并将最近收到的回复当作垃圾丢弃。
2. 所有成员成功将结果显示之后。将grpc调用结果返回给客户端，这就宣布调用成功。

###### 6、GPRC机制

1. 采用全局绑定和本地绑定两个级别的绑定架构；
2. 当RSG的任何成员启动时，它将首先在本地绑定上注册自己，然后在全局绑定上注册。加入集体行动就此结束。在它加入RSG之后，这个特定的RSG成员准备接受相应的远程服务请求。它可以通过退出群体行动而停止向外部世界提供服务。当它从RSG中退出时，这个特定的成员将首先从全局绑定中取消自己，然后再从本地绑定中取消自己

###### 7、三种 grpc机制比较

1. lookup GRPC机制：不要求事件交付的原子性和顺序;
2. 函数收敛GRPC机制：需要事件的原子交付；
3. update GRPC机制：需要事件交付的原子性和顺序；
   1. 当全局绑定器将被调用的RSG的成员信息返回到相应的客户端存根时，全局绑定器也会为GRPC调用分配唯一的事务标识符，它是一个单调的序列号，同时paggyback它。然后，客户机存根根据这个惟一的事务标识符构建远程服务请求消息。当被调用组的相应本地服务器存根接收到远程服务请求消息时，每个相应的本地服务器存根将调度并执行特定的被调用服务器过程。被调用的服务器的调度过程是基于事务标识符的单调序列顺序接收的远程服务请求消息和遵循这些规则,丢弃过时的远程服务请求消息,排队是早期的远程服务请求消息,执行远程服务请求消息。这确保了事件交付在被调用的RSG一侧的顺序。



